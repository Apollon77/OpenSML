/*!
 * OpenSML
 * Copyright(c) 2014-2015 D. Spautz (d.spautz@web.de)
 * MIT Licensed
 */

var chai = require('chai');
chai.use(require('chai-change'));

var expect = require("chai").expect;
var should = require('chai').should;

describe("SmlFile", function() {

	var SmlFile = require("../lib/SmlFile");
	var Constants = require('../lib/Constants');
		   
	describe("SmlFile()", function(){
				  
		it("should set default values", function(){	   
			var smlFile = new SmlFile();
		});
		  
	});
	
	describe("write()", function(){	  
	});
	
	describe("getSize()", function(){	  
	});

	describe("parse()", function () {
		it("should parse with 3 messages", function () {
			var smlFile = new SmlFile();
			var buffer = Buffer.from("1B1B1B1B01010101760400000162006200726500000101760101070000011D5C360B0A01484C59020001206A0101637DC60076040000026200620072650000070177010B0A01484C59020001206A0101F10477070100603201010101010104484C590177070100600100FF010101010B0A01484C59020001206A0177070100010800FF65001C010465011D5C36621E52FF6500DDC7560177070100020800FF65001C010465011D5C36621E52FF62000177070100100700FF0101621B52005302C80177070100200700FF0101622352FF6308F10177070100340700FF0101622352FF6308E40177070100480700FF0101622352FF6308EF01770701001F0700FF0101622152FE62260177070100330700FF0101622152FE62C90177070100470700FF0101622152FE62940177070100510701FF01016208520062790177070100510702FF01016208520062F00177070100510704FF010162085200620D017707010051070FFF01016208520063013F017707010051071AFF01016208520063014401770701000E0700FF0101622C52FF6301F30177070100000200000101010109312E30322E3030370177070100605A02010101010105413031410177070100600500FF0101010165001C010401010163522400760400000362006200726500000201710163EBF4000000001B1B1B1B1A03F406", "hex");
			smlFile.parse(buffer);
			expect(smlFile.messages.length).to.be.equal(3);
		});

		it("should parse with valid crc", function () {
			var smlFile = new SmlFile();
			var buffer = Buffer.from("1B1B1B1B01010101760400000162006200726500000101760101070000011D5C360B0A01484C59020001206A0101637DC60076040000026200620072650000070177010B0A01484C59020001206A0101F10477070100603201010101010104484C590177070100600100FF010101010B0A01484C59020001206A0177070100010800FF65001C010465011D5C36621E52FF6500DDC7560177070100020800FF65001C010465011D5C36621E52FF62000177070100100700FF0101621B52005302C80177070100200700FF0101622352FF6308F10177070100340700FF0101622352FF6308E40177070100480700FF0101622352FF6308EF01770701001F0700FF0101622152FE62260177070100330700FF0101622152FE62C90177070100470700FF0101622152FE62940177070100510701FF01016208520062790177070100510702FF01016208520062F00177070100510704FF010162085200620D017707010051070FFF01016208520063013F017707010051071AFF01016208520063014401770701000E0700FF0101622C52FF6301F30177070100000200000101010109312E30322E3030370177070100605A02010101010105413031410177070100600500FF0101010165001C010401010163522400760400000362006200726500000201710163EBF4000000001B1B1B1B1A03F406", "hex");
			smlFile.parse(buffer);
			expect(smlFile.valid).to.be.true;
		});
	});

});